{% extends "base.html" %}
{% load staticfiles %}
{% block title %}
作者详情 | wangjojo的博客
{% endblock title%}

{% block sidebar1 %}
    <div class="am-u-md-4 am-u-sm-12 blog-sidebar">
        <div class="blog-sidebar-widget blog-bor">
            <h2 class="blog-text-center blog-title"><span>About ME</span></h2>
            <img src="{{ MEDIA_URL }}{{ author.image }}" alt="about me" class="blog-entry-img" >
            <p><button type="button" class="am-btn am-btn-default am-active am-round">{{ author.nick_name }}</button></p>
            <p>{{ author.desc }}</p>
            <button type="button" class="am-btn am-btn-primary" id="fav_author">{% if has_fav %}已关注{% else %}关注{% endif %}</button>
        </div>
        <div class="blog-sidebar-widget blog-bor">
            <h2 class="blog-text-center blog-title"><span>Contact ME</span></h2>
            <p>
                <a href=""><span class="am-icon-qq am-icon-fw am-primary blog-icon"></span></a>
                <a href=""><span class="am-icon-github am-icon-fw blog-icon"></span></a>
                <a href=""><span class="am-icon-weibo am-icon-fw blog-icon"></span></a>
                <a href=""><span class="am-icon-reddit am-icon-fw blog-icon"></span></a>
                <a href=""><span class="am-icon-weixin am-icon-fw blog-icon"></span></a>
            </p>
        </div>
        <div class="blog-clear-margin blog-sidebar-widget blog-bor am-g ">
            <h2 class="blog-title"><span>TAG cloud</span></h2>
            <div class="am-u-sm-12 blog-clear-padding">
            <a href="" class="blog-tag">amaze</a>
            <a href="" class="blog-tag">妹纸 UI</a>
            <a href="" class="blog-tag">HTML5</a>
            <a href="" class="blog-tag">这是标签</a>
            <a href="" class="blog-tag">Impossible</a>
            <a href="" class="blog-tag">开源前端框架</a>
            </div>
        </div>
        <div class="blog-sidebar-widget blog-bor">
            <h2 class="blog-title"><span>么么哒</span></h2>
            <ul class="am-list">
                <li><a href="#">每个人都有一个死角， 自己走不出来，别人也闯不进去。</a></li>
                <li><a href="#">我把最深沉的秘密放在那里。</a></li>
                <li><a href="#">你不懂我，我不怪你。</a></li>
                <li><a href="#">每个人都有一道伤口， 或深或浅，盖上布，以为不存在。</a></li>
            </ul>
        </div>
    </div>      
{% endblock sidebar1 %}

{% block article %}
    <div class="am-u-md-8 am-u-sm-12">
        {% for blog in all_blogs %}
        <article class="am-g blog-entry-article">
            <div class="am-u-lg-6 am-u-md-12 am-u-sm-12 blog-entry-img">
                <img src="{{ MEDIA_URL }}{{ blog.image }}" alt="" class="am-u-sm-12">
            </div>
            <div class="am-u-lg-6 am-u-md-12 am-u-sm-12 blog-entry-text">
                <span><a href="{% url 'blog:blog_category' blog.category.id %}" class="blog-color">{{ blog.category.name }} &nbsp;</a></span>
                <span><a href="#">{{ blog.author.nick_name }}</a> &nbsp;</span>
                <span>{{ blog.add_time }}</span>
                <h1><a href="{% url 'blog:blog_detail' blog.id %}">{{ blog.title }}</a></h1>
                <p>{{ blog.content|slice:'100' }}</p>
                <p><a href="{% url 'blog:blog_detail' blog.id %}">continue reading</a></p>
                <hr>
                <span>点击：</span><span>收藏</span>
            </div>
        </article>            
        {% endfor %}

  
        <ul class="am-pagination">
          <li class="am-pagination-prev"><a href="">&laquo; Prev</a></li>
          <li class="am-pagination-next"><a href="">Next &raquo;</a></li>
        </ul>
    </div>      
{% endblock article %}

{% block sidebar2 %}
{% endblock sidebar2 %}

{% block custom_js %}
<script type="text/javascript">
//收藏分享
function add_fav(current_elem, fav_id, fav_type){
    $.ajax({
        cache: false,
        type: "POST",
        url:"{% url 'user:add_fav' %}",
        data:{'fav_id':fav_id, 'fav_type':fav_type},
        async: true,
        beforeSend:function(xhr, settings){
            xhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}' );
        },
        success: function(data) {
            if(data.status == 'fail'){
                if(data.msg == '用户未登录'){
                    window.location.href="{% url 'index' %}";
                }else{
                    alert(data.msg)
                }

            }else if(data.status == 'success'){
                current_elem.text(data.msg)
            }
        },
    });
}

$('#fav_author').on('click', function(){
    add_fav($(this), {{ author.id }}, 2);
});

</script>
{% endblock custom_js %}    
